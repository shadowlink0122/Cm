<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cm Todo App</title>
    <meta name="description" content="Cm言語で構築されたWebアプリケーション - with Cssによる自動スタイル生成">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app" id="app">
        <div class="header">
            <h1>📝 Cm Todo App</h1>
            <p>Cm言語 + JSバックエンドで構築</p>
        </div>

        <div class="card">
            <div style="display: flex; gap: 8px;">
                <input class="input" type="text" id="taskInput" placeholder="新しいタスクを入力..." style="flex: 1;">
                <button class="btn" id="addBtn" onclick="addTask()">追加</button>
            </div>
        </div>

        <div class="card" id="taskList">
            <h2 style="margin-bottom: 12px; color: #374151;">タスク一覧</h2>
            <div id="tasks"></div>
            <p id="emptyMsg" style="color: #9ca3af; text-align: center; padding: 20px;">
                タスクがありません。上のフォームから追加してください。
            </p>
        </div>

        <div class="card" style="text-align: center; color: #6b7280; font-size: 13px;">
            <p>このアプリのCSSは <code>with Css</code> による自動生成です</p>
            <p>ソース: <code>src/app.cm</code> → <code>public/app.js</code></p>
        </div>
    </div>

    <script>
        // タスクデータ
        let tasks = [];
        let nextId = 1;

        // タスク追加
        function addTask() {
            const input = document.getElementById('taskInput');
            const text = input.value.trim();
            if (!text) return;
            tasks.push({ id: nextId++, text: text, done: false });
            input.value = '';
            render();
        }

        // タスク完了トグル
        function toggleTask(id) {
            const task = tasks.find(t => t.id === id);
            if (task) task.done = !task.done;
            render();
        }

        // タスク削除
        function deleteTask(id) {
            tasks = tasks.filter(t => t.id !== id);
            render();
        }

        // 描画
        function render() {
            const container = document.getElementById('tasks');
            const emptyMsg = document.getElementById('emptyMsg');
            emptyMsg.style.display = tasks.length === 0 ? 'block' : 'none';

            container.innerHTML = tasks.map(t => `
                <div class="task-item">
                    <input type="checkbox" ${t.done ? 'checked' : ''}
                           onchange="toggleTask(${t.id})"
                           style="margin-right: 12px; width: 18px; height: 18px;">
                    <span style="flex: 1; ${t.done ? 'text-decoration: line-through; color: #9ca3af;' : ''}">${t.text}</span>
                    <button onclick="deleteTask(${t.id})"
                            style="background: none; border: none; color: #ef4444; cursor: pointer; font-size: 18px;">✕</button>
                </div>
            `).join('');
        }

        // Enterキーで追加
        document.getElementById('taskInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') addTask();
        });

        render();
    </script>

    <!-- Cm生成のJSを読み込み（CSS生成ロジック等に利用可能） -->
    <!-- <script src="app.js"></script> -->
</body>

</html>