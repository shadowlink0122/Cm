# Cm (ã‚·ãƒ¼ãƒã‚¤ãƒŠãƒ¼) ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ğŸš§ è¨­è¨ˆãƒ»é–‹ç™ºä¸­

## æ¦‚è¦

Cmï¼ˆã‚·ãƒ¼ãƒã‚¤ãƒŠãƒ¼ï¼‰ã¯ã€[Cbè¨€èª](https://github.com/shadowlink0122/Cb)ã®è¨­è¨ˆãƒ¬ãƒ™ãƒ«ã‹ã‚‰ã®ãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚

**OSãªã©ã®ä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‹ã‚‰ã€ã‚¦ã‚§ãƒ–ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¾ã§**ã‚’å˜ä¸€ã®è¨€èªã§è¨˜è¿°ã§ãã‚‹ã€æ¬¡ä¸–ä»£ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚

### ç‰¹å¾´

- âš¡ **LLVMãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: LLVM IRã«ã‚ˆã‚‹é«˜é€Ÿãªãƒã‚¤ãƒ†ã‚£ãƒ–ãƒã‚¤ãƒŠãƒªç”Ÿæˆ
- ğŸŒ **ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **: LLVMçµŒç”±ã§Linux/macOS/Windows/WASMå¯¾å¿œ
- ğŸ•¸ï¸ **WebAssemblyå¯¾å¿œ**: `--target=wasm`ã§ç›´æ¥WASMãƒã‚¤ãƒŠãƒªç”Ÿæˆ
- ğŸ¸ **gen (å¼¦)**: çµ±åˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
- ğŸš€ **C++é¢¨æ§‹æ–‡**: é¦´æŸ“ã¿ã‚„ã™ã„æ§‹æ–‡ã€ãƒ¢ãƒ€ãƒ³ãªè¨€èªæ©Ÿèƒ½
- ğŸ“ **Rustã‚¹ã‚¿ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: `{}`ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã«ã‚ˆã‚‹æŸ”è»Ÿãªæ–‡å­—åˆ—ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- ğŸ§¬ **ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹**: å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã‚‹æ±ç”¨ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°

> **Note**: 2024å¹´12æœˆã‚ˆã‚Šã€LLVMãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’å”¯ä¸€ã®ã‚³ãƒ¼ãƒ‰ç”Ÿæˆæ–¹å¼ã¨ã—ã¦æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚
> ä»¥å‰æ¤œè¨ã•ã‚Œã¦ã„ãŸRust/TypeScript/C++ã¸ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã¯ä»Šå¾Œè¡Œã„ã¾ã›ã‚“ã€‚

## ã‚³ãƒ¼ãƒ‰ä¾‹

```cpp
// é–¢æ•°å®šç¾©ï¼ˆC++é¢¨ï¼šæˆ»ã‚Šå€¤å‹ãŒå…ˆï¼‰
int add(int a, int b) {
    return a + b;
}

// ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ–‡å­—åˆ—ï¼ˆå¤‰æ•°è‡ªå‹•ã‚­ãƒ£ãƒ—ãƒãƒ£ï¼‰
import std::io::println;
int main() {
    int x = 10, y = 20;
    println("x = {x}, y = {y}");  // å¤‰æ•°ã‚’è‡ªå‹•çš„ã«ã‚­ãƒ£ãƒ—ãƒãƒ£
    return 0;
}

// ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹
T identity<T>(T value) {
    return value;
}

// æ§‹é€ ä½“
struct Point {
    int x;
    int y;
};

// ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨å®Ÿè£…
interface Printable {
    void print();
};

impl Printable for Point {
    void print() {
        println("(${this.x}, ${this.y})");
    }
};

// async/await
async String fetchData(String url) {
    Response res = await http::get(url);
    return res.body;
}

// ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒ
int getValue(Option<int> opt) {
    match (opt) {
        Some(v) => return v;
        None => return 0;
    }
}
```

## ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

```
Cm Source (.cm)
    â”‚
    â–¼
Lexer â†’ Parser â†’ AST â†’ TypeCheck â†’ HIR â†’ MIR
                                         â”‚
                                         â–¼
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                   â”‚  LLVM IR    â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼                               â–¼                               â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  x86_64 â”‚                    â”‚   ARM64  â”‚                    â”‚  WASM   â”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
          â”‚                              â”‚                               â”‚
          â–¼                              â–¼                               â–¼
    Linux/Windows/macOS            macOS/Linux/çµ„ã¿è¾¼ã¿               Browser
```

> **Note**: Rust/TypeScript/C++ã¸ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«æ©Ÿèƒ½ã¯å»ƒæ­¢ã•ã‚Œã¾ã—ãŸã€‚
> ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã¯LLVM IRã‚’çµŒç”±ã—ã¦è¡Œã‚ã‚Œã¾ã™ã€‚

## ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ : gen (å¼¦)

> ğŸ’¡ Cb/CmãŒéŸ³æ¥½ï¼ˆã‚³ãƒ¼ãƒ‰åï¼‰ã«ç”±æ¥ã™ã‚‹ã“ã¨ã‹ã‚‰ã€ã€Œå¼¦ã€ã‚’ãƒ¢ãƒãƒ¼ãƒ•ã«ã—ã¦ã„ã¾ã™ã€‚

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†

```bash
gen install cm@1.0.0     # Cmãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
gen use 1.0.0            # ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®š
gen use 0.9.0 --local    # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰è¨­å®š
```

### ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
gen init my-app

# ä¾å­˜è¿½åŠ 
gen add cm-json
gen add cm-http --dev

# ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ„ãƒ¼ãƒ«
gen install -g cm-fmt
gen install -g cm-lsp
```

### Cm.toml

```toml
[package]
name = "my-app"
version = "0.1.0"

[dependencies]
cm-std = "1.0"
cm-json = "0.5"

[build]
optimization = 2  # -O2

[target.native]
triple = "x86_64-unknown-linux-gnu"

[target.wasm]
triple = "wasm32-unknown-unknown"
```

## CLIä½¿ç”¨æ–¹æ³•

```bash
# å®Ÿè¡Œï¼ˆLLVM JITã¾ãŸã¯ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ï¼‰
cm run example.cm          # ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œ
cm run example.cm -d       # ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ä»˜ã
cm run example.cm --verbose # è©³ç´°è¡¨ç¤º

# ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ï¼ˆLLVMãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰
cm compile example.cm                  # ãƒã‚¤ãƒ†ã‚£ãƒ–ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
cm compile example.cm -o myprogram     # å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åæŒ‡å®š
cm compile example.cm -O3              # æœ€é©åŒ–ãƒ¬ãƒ™ãƒ«3
cm compile example.cm --emit=llvm-ir   # LLVM IRå‡ºåŠ›
cm compile example.cm --target=wasm    # WebAssemblyå‡ºåŠ›

# æ§‹æ–‡ãƒã‚§ãƒƒã‚¯
cm check example.cm        # å‹ãƒã‚§ãƒƒã‚¯ã®ã¿

# ãƒ˜ãƒ«ãƒ—
cm help                    # ãƒ˜ãƒ«ãƒ—è¡¨ç¤º
```

> **Note**: `--emit-rust`ã€`--emit-ts`ã€`--emit-cpp` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯å»ƒæ­¢ã•ã‚Œã¾ã—ãŸã€‚

### ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ–‡å­—åˆ—

Rustã‚¹ã‚¿ã‚¤ãƒ«ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ–‡å­—åˆ—ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ï¼š

```cm
import std::io::println;

int main() {
    int n = 255;
    double pi = 3.14159;
    
    // åŸºæœ¬çš„ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
    println("Value: {}", n);           // Value: 255
    
    // åŸºæ•°å¤‰æ›
    println("Hex: {:x}", n);           // Hex: ff
    println("Binary: {:b}", n);        // Binary: 11111111
    
    // æµ®å‹•å°æ•°ç‚¹ã®ç²¾åº¦
    println("Pi: {:.2}", pi);          // Pi: 3.14
    
    // ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ
    println("|{:<10}|", "left");       // |left      |
    println("|{:>10}|", "right");      // |      right|
    println("|{:^10}|", "center");     // |  center  |
    
    // ã‚¼ãƒ­åŸ‹ã‚
    println("{:0>5}", 42);             // 00042
    
    return 0;
}
```

## é–‹ç™ºè¨€èª

- **C++20** (Clang 17+æ¨å¥¨, GCC 13+, MSVC 2019+)

## CI/CD ãƒ†ã‚¹ãƒˆãƒãƒˆãƒªã‚¯ã‚¹

GitHub Actionsã§å…¨ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãƒ»å…¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®è‡ªå‹•ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã„ã¾ã™ï¼š

### ãƒ†ã‚¹ãƒˆæ§‹æˆ (3 OS Ã— 3 Backends = 9 configurations)

| OS | Interpreter | LLVM Native | LLVM WASM |
|----|-------------|-------------|-----------|
| **Ubuntu 22.04** | âœ… | âœ… | âœ… |
| **macOS 13** | âœ… | âœ… | âœ… |
| **Windows 2022** | âœ… | âœ… | âœ… |

### ãƒ†ã‚¹ãƒˆå†…å®¹
- **C++ Unit Tests**: GoogleTestã«ã‚ˆã‚‹å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆLexer, HIR, MIR, æœ€é©åŒ–ï¼‰
- **Interpreter Tests**: 134å€‹ã®Cmãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã§å®Ÿè¡Œ
- **LLVM Native Tests**: 134å€‹ã®Cmãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒã‚¤ãƒŠãƒªã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ»å®Ÿè¡Œ
- **LLVM WASM Tests**: 134å€‹ã®Cmãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’WASMã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ»Wasmtimeã§å®Ÿè¡Œ

### ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆ
make test

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰åˆ¥
make test-interpreter-parallel  # ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ãƒ†ã‚¹ãƒˆï¼ˆä¸¦åˆ—å®Ÿè¡Œï¼‰
make test-llvm-parallel         # LLVMãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ†ã‚¹ãƒˆï¼ˆä¸¦åˆ—å®Ÿè¡Œï¼‰
make test-wasm-parallel         # LLVM WASMãƒ†ã‚¹ãƒˆï¼ˆä¸¦åˆ—å®Ÿè¡Œï¼‰

# å€‹åˆ¥ã‚«ãƒ†ã‚´ãƒª
./tests/unified_test_runner.sh -b interpreter -c basic
./tests/unified_test_runner.sh -b llvm -c generics
```

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### é–‹ç™ºè€…å‘ã‘
- [ãƒ†ã‚¹ãƒˆã‚¬ã‚¤ãƒ‰](docs/tests/TESTING_GUIDE.md) - ãƒ†ã‚¹ãƒˆã®ä½œæˆã¨å®Ÿè¡Œæ–¹æ³•
- [ãƒ†ã‚¹ãƒˆ ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](docs/tests/TEST_QUICK_REFERENCE.md) - ã‚ˆãä½¿ã†ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰é›†
- [è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](docs/design/README.md) - æœªå®Ÿè£…æ©Ÿèƒ½ã®è¨­è¨ˆæ›¸
- [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](docs/design/archive/architecture.md) - ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ
- [HIRè¨­è¨ˆ](docs/design/hir.md)
- [ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰](docs/design/backends.md)
- [LLVMãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…](docs/llvm_backend_implementation.md)
- [LLVMãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ–ãƒ©ãƒª](docs/LLVM_RUNTIME_LIBRARY.md)
- [LLVMæœ€é©åŒ–ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³](docs/LLVM_OPTIMIZATION.md)
- [ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ–‡å­—åˆ—](docs/STRING_INTERPOLATION_LLVM.md)
- [FFIè¨­è¨ˆ](docs/design/ffi.md)
- [ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£](docs/design/package_manager.md)
- [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçŠ¶æ³](docs/PROJECT_STATUS.md)

## é–¢é€£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

- [Cbè¨€èª](https://github.com/shadowlink0122/Cb) - æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å‰èº«

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

æ¤œè¨ä¸­

---

Â© 2024-2025 Cmè¨€èªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ