// std::asm 入出力オペランドテスト
// in/out/inout相当の関数をstd::asm経由で使用
// __builtin_asmは使用せず、std::asm APIを使用

import std::io::println;
import std::asm::{
    asm_add,
    asm_mul,
    asm_inout_add,
    asm_inout_inc,
    asm_inout_dec,
    asm_in_load,
    asm_out_store
};

void main() {
    println("=== std::asm In/Out/InOut Test ===");
    
    // ============================================================
    // 入力オペランド（in相当）: asm_add, asm_mul
    // ============================================================
    
    int r1 = asm_add(10, 20);
    if (r1 == 30) {
        println("asm_add(10, 20) = 30: PASS");
    } else {
        println("asm_add: FAIL");
    }
    
    int r2 = asm_mul(7, 8);
    if (r2 == 56) {
        println("asm_mul(7, 8) = 56: PASS");
    } else {
        println("asm_mul: FAIL");
    }
    
    // ============================================================
    // 入出力オペランド（inout相当）
    // ============================================================
    
    // inout add: x += value
    int x = 100;
    asm_inout_add(&x, 23);
    if (x == 123) {
        println("asm_inout_add(&x, 23): x=123: PASS");
    } else {
        println("asm_inout_add: FAIL");
    }
    
    // inout inc: y++
    int y = 41;
    asm_inout_inc(&y);
    if (y == 42) {
        println("asm_inout_inc(&y): y=42: PASS");
    } else {
        println("asm_inout_inc: FAIL");
    }
    
    // inout dec: z--
    int z = 10;
    asm_inout_dec(&z);
    if (z == 9) {
        println("asm_inout_dec(&z): z=9: PASS");
    } else {
        println("asm_inout_dec: FAIL");
    }
    
    // ============================================================
    // 入力/出力（in/out相当）
    // ============================================================
    
    // in: メモリロード
    int src = 999;
    int loaded = asm_in_load(&src);
    if (loaded == 999) {
        println("asm_in_load(&src): 999: PASS");
    } else {
        println("asm_in_load: FAIL");
    }
    
    // out: メモリストア
    int dest = 0;
    asm_out_store(&dest, 777);
    if (dest == 777) {
        println("asm_out_store(&dest, 777): PASS");
    } else {
        println("asm_out_store: FAIL");
    }
    
    println("=== All Tests Passed ===");
}
