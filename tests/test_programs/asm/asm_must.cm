// must {} ブロック構文テスト
// mustブロック内のコードはデッドコード最適化禁止

import std::io::println;

void main() {
    println("=== must {} Block Test ===");
    
    // 基本的なmustブロック
    int x = 0;
    must {
        x = 10;  // この代入は最適化で消えない
        x = 20;  // この代入も最適化で消えない
    }
    if (x == 20) {
        println("must block basic: PASS");
    } else {
        println("must block basic: FAIL");
    }
    
    // mustブロック内でasm使用
    must {
        __builtin_asm("nop");
        __builtin_asm("nop");
        __builtin_asm("nop");
    }
    println("must block with asm: PASS");
    
    // ネストしたmustブロック
    int y = 0;
    must {
        y = 1;
        must {
            y = 2;
        }
        y = 3;
    }
    if (y == 3) {
        println("nested must blocks: PASS");
    } else {
        println("nested must blocks: FAIL");
    }
    
    println("=== All Tests Passed ===");
}
