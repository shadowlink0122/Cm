// vector.cm - ベクトル演算の実装（内部ファイル）
// module文なし = 内部実装ファイル

struct Vector3 {
    float x;
    float y;
    float z;
}

float dot(Vector3 a, Vector3 b) {
    return a.x * b.x + a.y * b.y + a.z * b.z;
}

Vector3 cross(Vector3 a, Vector3 b) {
    return Vector3 {
        x: a.y * b.z - a.z * b.y,
        y: a.z * b.x - a.x * b.z,
        z: a.x * b.y - a.y * b.x
    };
}

// 二乗距離を返す（sqrt不要）
float magnitude_squared(Vector3 v) {
    return dot(v, v);
}

// 単純化した正規化
Vector3 normalize(Vector3 v) {
    const float m = magnitude_squared(v);
    return Vector3 {
        x: v.x / m,
        y: v.y / m,
        z: v.z / m
    };
}

// mathモジュール内でのみ使用可能
export {
    Vector3,
    dot,
    cross,
    normalize
};
