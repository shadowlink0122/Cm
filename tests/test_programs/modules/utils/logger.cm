// utils/logger.cm - ロガーモジュール
// 同じディレクトリからの相対インポート

// 同じディレクトリのcommonモジュールをインポート
import ./common;

// ログレベル
export enum LogLevel {
    DEBUG,
    INFO,
    WARN,
    ERROR
};

// ロガー構造体
export struct Logger {
    LogLevel level;
    common::Config config;
};

// エクスポート関数
export void log(Logger logger, LogLevel level, string message) {
    if (level >= logger.level) {
        string level_str = get_level_string(level);
        println("[{level_str}] {message}");
        println("  App: {logger.config.name}");
    }
}

export Logger create_logger(LogLevel level) {
    Logger logger;
    logger.level = level;
    logger.config = common::create_default_config();
    return logger;
}

// プライベート関数
string get_level_string(LogLevel level) {
    if (level == LogLevel::DEBUG) return "DEBUG";
    if (level == LogLevel::INFO) return "INFO";
    if (level == LogLevel::WARN) return "WARN";
    if (level == LogLevel::ERROR) return "ERROR";
    return "UNKNOWN";
}