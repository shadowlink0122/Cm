---
title: v0.13.0
parent: Release Notes
nav_order: 1
---

# Cm v0.13.0 ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆ

**ãƒªãƒªãƒ¼ã‚¹æ—¥:** 2026-02-03

## âœ¨ ãƒã‚¤ãƒ©ã‚¤ãƒˆ

v0.13.0ã¯ã€**ã‚¹ãƒ¬ãƒƒãƒ‰APIåˆ·æ–°**ã€**async/awaitå‰Šé™¤**ã€**ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ï¼ˆEnumï¼‰**ã€**ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°å¼·åŒ–**ã‚’å«ã‚€ãƒªãƒªãƒ¼ã‚¹ã§ã™ã€‚

### ä¸»è¦ãªå¤‰æ›´ç‚¹

- **std::threadåˆ·æ–°**: libcã®pthreadã‚’ç›´æ¥ä½¿ç”¨ã™ã‚‹ã‚·ãƒ³ãƒ—ãƒ«ãªAPI
- **async/awaitå‰Šé™¤**: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ¬ãƒ™ãƒ«ã®async/awaitã‚’å‰Šé™¤ã€ã‚¹ãƒ¬ãƒƒãƒ‰ãƒ™ãƒ¼ã‚¹ã«ç§»è¡Œ
- **Enumå¼·åŒ–**: é–¢é€£ãƒ‡ãƒ¼ã‚¿ä»˜ãEnumã¨ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°
- **Match Guard**: ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã«ã‚¬ãƒ¼ãƒ‰æ¡ä»¶ã‚’è¿½åŠ 

---

## ğŸš€ æ–°æ©Ÿèƒ½

### std::thread APIï¼ˆpthreadç›´æ¥ä½¿ç”¨ï¼‰

libcã®pthreadã‚’ç›´æ¥ä½¿ç”¨ã™ã‚‹ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¹ãƒ¬ãƒƒãƒ‰APIã‚’å®Ÿè£…ã—ã¾ã—ãŸï¼š

```cm
import std::thread::spawn;
import std::thread::join;
import std::thread::detach;
import std::thread::sleep_ms;

void* worker(void* arg) {
    println("Worker: start");
    sleep_ms(100);
    println("Worker: done");
    return 42 as void*;
}

int main() {
    // ã‚¹ãƒ¬ãƒƒãƒ‰ç”Ÿæˆ
    ulong t = spawn(worker as void*);
    
    // å®Œäº†å¾…æ©Ÿã¨çµæœå–å¾—
    int result = join(t);
    println("Result: {result}");
    
    // ãƒ‡ã‚¿ãƒƒãƒï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œï¼‰
    ulong t2 = spawn(worker as void*);
    detach(t2);
    
    return 0;
}
```

**API:**
- `spawn(fn)` - æ–°ã—ã„ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ç”Ÿæˆ
- `join(handle)` - ã‚¹ãƒ¬ãƒƒãƒ‰å®Œäº†ã‚’å¾…æ©Ÿã—çµæœã‚’å–å¾—
- `detach(handle)` - ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ãƒ‡ã‚¿ãƒƒãƒï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œï¼‰
- `sleep_ms(ms)` - æŒ‡å®šãƒŸãƒªç§’ã‚¹ãƒªãƒ¼ãƒ—

### async/awaitå‰Šé™¤

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ¬ãƒ™ãƒ«ã®async/awaitã‚µãƒãƒ¼ãƒˆã‚’å‰Šé™¤ã—ã¾ã—ãŸï¼š

- `async`/`await`ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ä½¿ç”¨ä¸å¯
- éåŒæœŸå‡¦ç†ã¯`std::thread`ã‚’ä½¿ç”¨ã—ã¦å®Ÿè£…
- `no_std`ç’°å¢ƒã§ã®ã‚ˆã‚Šã‚·ãƒ³ãƒ—ãƒ«ãªå®Ÿè£…ãŒå¯èƒ½ã«

### Enumå¼·åŒ–ï¼ˆé–¢é€£ãƒ‡ãƒ¼ã‚¿ä»˜ãï¼‰

```cm
enum Option<T> {
    Some(T),
    None
}

int main() {
    Option<int> opt = Option::Some(42);
    
    match (opt) {
        Some(v) => println("Value: {v}"),
        None => println("No value")
    }
    
    return 0;
}
```

### Result/Optionãƒ‘ã‚¿ãƒ¼ãƒ³

ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã«ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ã®`Result<T, E>`ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š

```cm
enum Result<T, E> {
    Ok(T),
    Err(E)
}

Result<int, string> safe_divide(int a, int b) {
    if (b == 0) {
        return Result::Err("Division by zero");
    }
    return Result::Ok(a / b);
}

int main() {
    match (safe_divide(10, 2)) {
        Result::Ok(v) => { println("Result: {v}"); }
        Result::Err(e) => { println("Error: {e}"); }
    }
    return 0;
}
```

**æ³¨æ„:** `Result`ã¨`Option`ã¯çµ„ã¿è¾¼ã¿å‹ã§ã¯ãªãã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ˜ç¤ºçš„ã«enumå®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### Match Guard

ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã«ã‚¬ãƒ¼ãƒ‰æ¡ä»¶ã‚’è¿½åŠ ã§ãã¾ã™ï¼š

```cm
match (value) {
    x if x > 0 => println("positive"),
    x if x < 0 => println("negative"),
    _ => println("zero")
}
```

---

## ğŸ”§ ç ´å£Šçš„å¤‰æ›´

### async/awaitå‰Šé™¤

- `async`é–¢æ•°å®£è¨€ã¯ä½¿ç”¨ä¸å¯
- `await`å¼ã¯ä½¿ç”¨ä¸å¯
- æ—¢å­˜ã®asyncã‚³ãƒ¼ãƒ‰ã¯`std::thread`ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†æ›¸ãæ›ãˆãŒå¿…è¦

**ç§»è¡Œä¾‹:**
```cm
// æ—§ (v0.12.0)
async int compute() {
    return 42;
}
int result = await compute();

// æ–° (v0.13.0)
void* compute(void* arg) {
    return 42 as void*;
}
ulong t = spawn(compute as void*);
int result = join(t);
```

---

## ğŸ“ ä¸»è¦ãªå¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«

### ã‚¹ãƒ¬ãƒƒãƒ‰API

| ãƒ•ã‚¡ã‚¤ãƒ« | å¤‰æ›´å†…å®¹ |
|---------|---------|
| `std/thread/mod.cm` | pthreadç›´æ¥ä½¿ç”¨ã«å¤‰æ›´ |
| `src/codegen/llvm/native/runtime_sync.c` | Futureé–¢é€£é–¢æ•°å‰Šé™¤ |
| `src/frontend/types/checking/call.cpp` | println/printç‰¹åˆ¥å‡¦ç†ç°¡ç•¥åŒ– |

### async/awaitå‰Šé™¤

| ãƒ•ã‚¡ã‚¤ãƒ« | å¤‰æ›´å†…å®¹ |
|---------|---------|
| `src/frontend/parser/parser.hpp` | async/awaitãƒ‘ãƒ¼ã‚¹å‡¦ç†å‰Šé™¤ |
| `src/frontend/ast/decl.hpp` | is_asyncãƒ•ãƒ©ã‚°å‰Šé™¤ |
| `src/hir/nodes.hpp` | HirAwaitå‰Šé™¤ |
| `src/mir/nodes.hpp` | MirAwaitå‰Šé™¤ |

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆçŠ¶æ³

| ã‚«ãƒ†ã‚´ãƒª | é€šé | å¤±æ•— | ã‚¹ã‚­ãƒƒãƒ— |
|---------|-----|------|---------|
| ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ | 339 | 0 | 13 |
| LLVM JIT | 337 | 1 | 14 |

**æ–°è¦ãƒ†ã‚¹ãƒˆ:**
- `thread/thread_basic.cm` - åŸºæœ¬çš„ãªã‚¹ãƒ¬ãƒƒãƒ‰æ“ä½œ
- `thread/thread_parallel.cm` - ä¸¦åˆ—ã‚¹ãƒ¬ãƒƒãƒ‰å®Ÿè¡Œ
- `thread/thread_join_test.cm` - join/detachå‹•ä½œç¢ºèª

---

## ğŸ“Š çµ±è¨ˆ

- **å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 28
- **è¿½åŠ è¡Œæ•°**: 293
- **å‰Šé™¤è¡Œæ•°**: 63

---

## ğŸ”® ä»Šå¾Œã®äºˆå®š

- **v0.14.0**: std::syncï¼ˆMutex, RwLockç­‰ï¼‰ã®å¼·åŒ–
- **v0.15.0**: ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ`gen`ï¼‰å®Ÿè£…

---

## ğŸ“ è¬è¾

ã“ã®ãƒªãƒªãƒ¼ã‚¹ã¯ã€ã‚¹ãƒ¬ãƒƒãƒ‰ãƒ¢ãƒ‡ãƒ«ã®ç°¡ç´ åŒ–ã¨`no_std`ç’°å¢ƒã¸ã®å¯¾å¿œã‚’ç›®æ¨™ã¨ã—ã¾ã—ãŸã€‚
