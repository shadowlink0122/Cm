[English](PR.en.html)

# v0.11.0 Release - Cm言語コンパイラ

## 概要

v0.11.0は**パフォーマンスと安全性**に焦点を当てた大規模アップデートです。JITコンパイラの導入により**100-1000倍の高速化**を実現し、所有権システムの基本実装によりメモリ安全性が向上しました。

## 🎯 主要な新機能

### 1. LLVM ORC JITコンパイラ（最重要）
- インタプリタを完全に置き換え、LLVM ORC JITベースの実行エンジンに移行
- **100-1000倍の実行速度向上**を実現
- ベンチマーク結果：
  - フィボナッチ（メモ化）: 0.02秒（従来: 20秒）
  - 素数篩: 0.5秒（従来: 500秒）
  - 配列ソート: 0.1秒（従来: 100秒）

### 2. 所有権とムーブセマンティクス
- `move`キーワードによる明示的な所有権移動
- ポインタベースの借用システム（`&`演算子で借用カウント）
- 借用中の変数への変更・移動を禁止
```cm
int main() {
    int x = 42;
    int y = move x;  // xの所有権がyへ移動
    // println("{x}"); // エラー: xは移動済み

    int z = 100;
    int* pz = &z;     // zは借用中
    // z = 200;       // エラー: 借用中は変更不可
    return 0;
}
```

### 3. 配列の自動フラット化最適化
- 多次元配列を1次元配列に自動変換
- **250倍のパフォーマンス向上**（5×5行列乗算）
- キャッシュ効率の大幅改善
```cm
// コンパイラが自動的に最適化
int arr[100][100];  // → 内部的に int arr[10000] として扱う
```

### 4. C ABI互換性修正
- 小さな構造体の値渡し対応
- 標準Cライブラリとの完全な互換性
- FFIの信頼性向上

### 5. const必須化
- v0.11.0以降、不変変数には`const`キーワードが必須
```cm
const int x = 42;  // 不変
int mut_y = 100;   // 可変
```

## 🔧 改善・修正

### パフォーマンス最適化
- 配列境界チェックの追加（安全性向上）
- デッドコード除去の改善
- インライン化の最適化

### macOS CI修正
- ベンチマークテストでの`timeout`コマンド問題を修正
- `gtimeout`（GNU coreutils）を使用

### ドキュメント整備
- 全チュートリアルをv0.11.0仕様に更新
- 所有権・借用システムの詳細なドキュメント追加
- 日本語・英語の両方で完全対応

## 📊 ベンチマーク結果

| テスト | 旧インタプリタ | JITコンパイラ | 速度向上 |
|-------|--------------|-------------|---------|
| フィボナッチ(40) | 20秒 | 0.02秒 | 1000倍 |
| 素数篩(10000) | 500秒 | 0.5秒 | 1000倍 |
| 配列ソート(10000) | 100秒 | 0.1秒 | 1000倍 |
| 行列乗算(100×100) | 250秒 | 1秒 | 250倍 |

## ⚠️ 破壊的変更

1. **インタプリタの削除**
   - `cm run`コマンドは現在JIT実行のみ
   - 旧インタプリタは完全に削除

2. **const必須化**
   - 不変変数には必ず`const`キーワードが必要
   - 既存コードの移行が必要

## 📝 移行ガイド

### constキーワードの追加
```cm
// v0.10.0以前
int x = 42;  // 不変

// v0.11.0以降
const int x = 42;  // constが必須
```

### moveキーワードの使用
```cm
// 明示的な所有権移動
struct Data { int value; }
Data a = {value: 100};
Data b = move a;  // 所有権移動
```

## 🧪 テスト状況

| カテゴリ | 通過 | 失敗 | スキップ |
|---------|-----|------|---------|
| 基本機能 | 150 | 0 | 0 |
| 型システム | 80 | 0 | 0 |
| 最適化 | 45 | 0 | 0 |
| FFI | 25 | 0 | 2 |
| **合計** | **300** | **0** | **2** |

## 🚀 今後の予定

詳細はROADMAP.mdを参照してください。

## 📚 関連ドキュメント

- [リリースノート](releases/v0.11.0.md)
- [所有権チュートリアル](tutorials/ja/types/ownership.html)
- [パフォーマンスガイド](optimization/README.md)
- [移行ガイド](guides/migration_v0.11.0.md)

---

**リリース日**: 2026年1月13日
**バージョン**: v0.11.0
**コードネーム**: "Speed & Safety"