# Cm言語 実装状況とロードマップ (v0.10.0 / v0.11.0)

**日付**: 2025年1月5日
**作成者**: Gemini Agent

## 1. v0.10.0 実装完了項目の再評価

最新のコード調査により、以下の機能が v0.10.0 で完全実装されていることが確認されました。

### 1.1 typedef ポインタの完全対応
- **内容**: `typedef Ptr = *int;` や `typedef NodePtr = *Node;` のような型エイリアスを介したポインタ操作。
- **状態**: ✅ **実装済み** (MIR/LLVMバックエンド共に再帰的解決をサポート)
- **ドキュメント修正**: 「予定」から「実装済み」へ昇格。

### 1.2 モジュールシステムの高度な構文（パース完了）
- **内容**: エイリアス付きインポート (`as`)、選択的インポート (`{}`), 再エクスポート (`export from`)。
- **状態**: 🟡 **部分実装** (パーサーは対応済みだが、名前解決に課題あり)

## 2. v0.11.0 開発ロードマップ

次バージョン v0.11.0 では、言語の堅牢性と実用的なエコシステムの構築に焦点を当てます。

### 2.1 C ABI 互換性の修正 (最優先)
- **課題**: 構造体の引数渡しがポインタに固定されており、標準Cライブラリとの互換性がない。
- **解決策**: 小さな構造体のレジスタ渡し、LLVM `byval` 属性の適切な利用。

### 2.2 メモリ管理の強化と安全性
- **メモリリーク修正**: スライス (`cm_slice_new`) およびランタイムが生成する文字列 (`read_file`, `input`) の自動解放の実装。
- **配列境界チェック**: ランタイムパニックを伴う境界チェックの導入。

### 2.3 I/Oシステムの堅牢化
- **ファイルI/Oのエラーハンドリング**: 失敗時に空文字列を返すだけでなく、エラー状態を取得できる仕組み（将来的なResult型導入への布石）。
- **標準入力の安定化**: `input_int` などのバッファリングや改行処理の改善。

### 2.3 静的解析とツール基盤
- **型チェッカーの堅牢化**: 循環参照型による無限再帰（スタックオーバーフロー）の修正。
- **Lint/Format基盤**: `Token` へのトリビア（空白・コメント）保持機能の追加。
- **const推奨警告**: 再代入のない変数に対する `const` 化の提案。

## 3. 実装状況一覧（最新版）

| カテゴリ | 機能 | インタプリタ | LLVM | WASM | 状況 |
|---------|------|------------|------|------|------|
| **型システム** | typedefポインタ | ✅ | ✅ | ✅ | v0.10.0 完了 |
| | Union/Literal型 | ✅ | ✅ | ✅ | v0.10.0 完了 |
| **モジュール** | エイリアス (as) | ✅ | 🟡 | 🟡 | 解析フェーズ改善中 |
| | 選択インポート | ✅ | 🟡 | 🟡 | 解析フェーズ改善中 |
| **高度** | with Eq/Ord | ✅ | ✅ | ✅ | v0.10.0 完了 |
| | 文字列スライス | ✅ | ✅ | ✅ | v0.10.0 完了 |
| **安全性** | 境界チェック | ❌ | ❌ | ❌ | v0.11.0 予定 |
| | ABI互換性 | ❌ | ❌ | ❌ | v0.11.0 予定 |

---

*最終更新: 2025-01-05*
