# Cm言語 開発ロードマップ

## 開発方針

> **並行開発原則**: インタプリタとコンパイラは常に同じ動作を保証するため、各機能を両方で同時に実装する

## Version 0.1.0 (現在) ✅

### 完成済み機能
- ✅ 基本的な式と文の実行（インタプリタ）
- ✅ フォーマット文字列（変数自動キャプチャ）
- ✅ MIRインタプリタ
- ✅ コマンドベースCLI
- ✅ デバッグシステム

## Version 0.2.0 - 構造体とメソッド

### 目標
構造体定義とメソッド呼び出しの完全サポート

### 実装項目
| 機能 | インタプリタ | コンパイラ（Rust） | テスト |
|------|-------------|------------------|--------|
| 構造体定義 | ⬜ | ⬜ | ⬜ |
| フィールドアクセス | ⬜ | ⬜ | ⬜ |
| メソッド定義 | ⬜ | ⬜ | ⬜ |
| コンストラクタ | ⬜ | ⬜ | ⬜ |
| thisポインタ | ⬜ | ⬜ | ⬜ |

### 成功基準
- 同一のCmコードがインタプリタとコンパイル後で同じ結果を出力

## Version 0.3.0 - エラーハンドリングとResult型

### 目標
安全なエラーハンドリングの実装

### 実装項目
| 機能 | インタプリタ | コンパイラ（Rust） | テスト |
|------|-------------|------------------|--------|
| Result<T, E>型 | ⬜ | ⬜ | ⬜ |
| Option<T>型 | ⬜ | ⬜ | ⬜ |
| ?演算子 | ⬜ | ⬜ | ⬜ |
| try-catch構文 | ⬜ | ⬜ | ⬜ |
| パニックハンドリング | ⬜ | ⬜ | ⬜ |

## Version 0.4.0 - 配列とコレクション

### 目標
動的・静的配列とベクター型の実装

### 実装項目
| 機能 | インタプリタ | コンパイラ（Rust） | テスト |
|------|-------------|------------------|--------|
| 固定長配列 [T; N] | ⬜ | ⬜ | ⬜ |
| 動的配列 Vec<T> | ⬜ | ⬜ | ⬜ |
| 文字列操作 | ⬜ | ⬜ | ⬜ |
| スライス操作 | ⬜ | ⬜ | ⬜ |
| イテレータ | ⬜ | ⬜ | ⬜ |

## Version 0.5.0 - インターフェースとトレイト

### 目標
抽象化メカニズムの実装

### 実装項目
| 機能 | インタプリタ | コンパイラ（Rust） | テスト |
|------|-------------|------------------|--------|
| interface定義 | ⬜ | ⬜ | ⬜ |
| impl for構文 | ⬜ | ⬜ | ⬜ |
| デフォルト実装 | ⬜ | ⬜ | ⬜ |
| トレイト境界 | ⬜ | ⬜ | ⬜ |
| 自動derive | ⬜ | ⬜ | ⬜ |

## Version 0.6.0 - ジェネリクス

### 目標
型パラメータとジェネリックプログラミング

### 実装項目
| 機能 | インタプリタ | コンパイラ（Rust） | テスト |
|------|-------------|------------------|--------|
| 関数ジェネリクス | ⬜ | ⬜ | ⬜ |
| 構造体ジェネリクス | ⬜ | ⬜ | ⬜ |
| 型制約 where句 | ⬜ | ⬜ | ⬜ |
| 関連型 | ⬜ | ⬜ | ⬜ |
| 型推論強化 | ⬜ | ⬜ | ⬜ |

## Version 0.7.0 - モジュールシステム

### 目標
完全なモジュールとパッケージ管理

### 実装項目
| 機能 | インタプリタ | コンパイラ（Rust） | テスト |
|------|-------------|------------------|--------|
| import/export | ⬜ | ⬜ | ⬜ |
| モジュール解決 | ⬜ | ⬜ | ⬜ |
| 標準ライブラリ | ⬜ | ⬜ | ⬜ |
| genパッケージマネージャ | ⬜ | ⬜ | ⬜ |
| 依存関係管理 | ⬜ | ⬜ | ⬜ |

## Version 0.8.0 - パターンマッチング

### 目標
強力なパターンマッチング機能

### 実装項目
| 機能 | インタプリタ | コンパイラ（Rust） | テスト |
|------|-------------|------------------|--------|
| match式 | ⬜ | ⬜ | ⬜ |
| enum型 | ⬜ | ⬜ | ⬜ |
| パターンガード | ⬜ | ⬜ | ⬜ |
| 構造化束縛 | ⬜ | ⬜ | ⬜ |
| 網羅性チェック | ⬜ | ⬜ | ⬜ |

## Version 0.9.0 - 非同期処理

### 目標
async/awaitとFuture型の実装

### 実装項目
| 機能 | インタプリタ | コンパイラ（Rust） | テスト |
|------|-------------|------------------|--------|
| async関数 | ⬜ | ⬜ | ⬜ |
| await式 | ⬜ | ⬜ | ⬜ |
| Future型 | ⬜ | ⬜ | ⬜ |
| ランタイム統合 | ⬜ | ⬜ | ⬜ |
| 並行処理 | ⬜ | ⬜ | ⬜ |

## Version 0.10.0 - TypeScript/WASMバックエンド

### 目標
Webプラットフォーム対応

### 実装項目
| 機能 | インタプリタ | TypeScript | WASM | テスト |
|------|-------------|-----------|------|--------|
| TypeScript生成 | N/A | ⬜ | N/A | ⬜ |
| WASM生成 | N/A | N/A | ⬜ | ⬜ |
| DOM API連携 | ⬜ | ⬜ | ⬜ | ⬜ |
| npm統合 | N/A | ⬜ | ⬜ | ⬜ |
| React/Vue連携 | N/A | ⬜ | ⬜ | ⬜ |

## Version 1.0.0 - 安定版リリース

### 達成条件
- ✅ すべてのコア機能の実装完了
- ✅ インタプリタとコンパイラの動作一致
- ✅ 包括的なテストスイート（>90%カバレッジ）
- ✅ ドキュメント完備
- ✅ genパッケージマネージャ完成
- ✅ エディタサポート（VSCode, Vim）
- ✅ 標準ライブラリ安定版

### 最終チェックリスト
- [ ] 言語仕様書の完成
- [ ] APIドキュメント
- [ ] チュートリアル
- [ ] サンプルプロジェクト
- [ ] パフォーマンスベンチマーク
- [ ] セキュリティ監査

## 並行開発の原則

### 1. 機能実装フロー
```
1. 言語機能の仕様策定
2. テストケース作成（期待される動作の定義）
3. インタプリタ実装
4. コンパイラ（Rust）実装
5. 両実装の出力比較テスト
6. 不一致があれば修正
7. ドキュメント更新
```

### 2. テスト戦略
- **ゴールデンテスト**: 同一入力に対する出力の完全一致確認
- **プロパティベーステスト**: ランダム入力での動作一致
- **境界値テスト**: エッジケースでの動作確認
- **パフォーマンステスト**: 実行速度の比較

### 3. CI/CDパイプライン
```yaml
test:
  - stage: unit_test
    - interpreter_tests
    - compiler_tests
  - stage: integration_test
    - compare_outputs
    - golden_tests
  - stage: benchmark
    - performance_comparison
```

## リスクと緩和策

| リスク | 影響度 | 緩和策 |
|--------|-------|--------|
| インタプリタ/コンパイラの動作不一致 | 高 | 各機能実装時に徹底的な比較テスト |
| パフォーマンス差が大きい | 中 | 最適化は別フェーズで実施 |
| 仕様変更による手戻り | 中 | 早期のプロトタイプと検証 |
| 依存関係の複雑化 | 低 | モジュール間の疎結合設計 |

## 次のアクション（v0.2.0に向けて）

1. **構造体のAST定義** - 1週間
2. **HIR/MIRへの構造体サポート追加** - 1週間
3. **インタプリタでの構造体実行** - 2週間
4. **Rustコード生成** - 2週間
5. **テストスイート作成** - 1週間
6. **ドキュメント更新** - 3日

**目標リリース日**: 2025年1月中旬